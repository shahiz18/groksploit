<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GrokSploit â€“ AI Pentest Assistant</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-dark text-light">

  <div class="container py-5">
    <h1 class="text-center mb-4">ğŸ§  GrokSploit â€“ AI-Assisted Pentesting</h1>

    <!-- ğŸ” Mode Switch -->
    <div class="mb-4 text-center">
      <a href="{{ url_for('main.attack_page') }}" class="btn btn-outline-light me-2">ğŸ§  Attack Mode</a>
      <a href="{{ url_for('main.chat_page') }}" class="btn btn-outline-info">ğŸ’¬ Chat Mode</a>
    </div>

    <!-- Page-Specific Content -->
    {% block content %}
    {% endblock %}
  </div>
<script>
  function enableEdit() {
    document.getElementById('editForm').style.display = 'block';
  }

  document.getElementById("streamForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);
  
  const outputDiv = document.getElementById("outputArea");
  outputDiv.innerHTML = "<em>â³ Running command...</em>";

  fetch("/stream_tool", {
    method: "POST",
    body: formData
  })
  .then(response => {
    const reader = response.body.getReader();
    const decoder = new TextDecoder();
    let result = "";

    function read() {
      return reader.read().then(({ done, value }) => {
        if (done) return;
        result += decoder.decode(value, { stream: true });
        outputDiv.innerHTML = result;
        return read();
      });
    }

    return read();
  });
});
</script>
</body>
</html>
